# Документация по клиенту и серверу (JSON)

# Сервер

## Интерфейс `ISerializable`

### 1. Сериализация
```C#
public string Serialize();
```
Метод используется для того, чтобы сериализовать экземпляр класса. Возвращает JSON

### 2. Выполнение сценария после того, как сервер получил данный объект класса 
```C#
public void Execute(Client client);
```
Метод вызывается сразу после успешной десериализации JSON'a.
В зависимости от полученного типа команды, выполняется какой-то сценарий. 
Аргумент `client` является клиентом, от которого пришел данный JSON 

## Класс `AuthReg : ISerializable`
### Свойства
```C#
public AuthRegTypeOfCommand TypeOfCommand { get; set; }
```
Тип команды. Свойсвто отвечает за обработку этого JSON'a сервером/клиентом.
Возможны следующие значения данного свойства:
* `Registration` - Если сервер получил данное значение, то выполняется сценарий регистрации пользователя.
  Нужные данные для этого сценария: 
  * `Login` - Логин пользователя.
  * `Password` - Пароль пользователя.
* `Authorization` - Если сервер получило данное значение, то выполняется сценарий авторизации пользователя.
Нужные данные для этого сценария:
    * `Login` - Логин пользователя.
    * `Password` - Пароль пользователя.

После выполнения любого из этих сценариев, свойства `Success` и `Message` должны быть заполнены и 
экземпляр этого класса должен быть отправлен клиенту, от которого пришел данный JSON.

```C#
public string Login { get; set; }
```
Логин пользователя

```C#
public string Password { get; set; }
```
Пароль пользователя

```C#
public bool Success { get; set; }
```
Является флагом успешной регистрации/авторизации для клиента.

```C#
public string Message { get; set; }
```
Сообщение, которое получит клиент после выполнения сценария.

```C#
public List<string> UserList { get; set; }
```
Список пользователей, которые есть в контактах у данного пользователя с логином `Login`. Инициализируется на сервере.

### Методы

### 1. Возможность десериализовать JSON в экземпляр класса `AuthReg`
```C#
public static bool CanDeserialize(string json)
```
Если был передан корректный JSON, который можно десериализовать в экземпляр данного класа,
то возвращается `true`, иначе `false`.

### 2. Десериализация JSON'a в экземпляр данного класса
```C#
public static AuthReg Deserialize(string json)
```
Возвращается экземпляр данного класса, либо `null`.

## Класс `Message : ISerializable`

### Свойства
```C#
public MessageTypeofCommand TypeOfCommand { get; set; }
```
Тип команды. Свойсвто отвечает за обработку этого JSON'a сервером/клиентом.
Возможны следующие значения данного свойства:
* `TextMessage` - Если сервер получил данное значение, то выполняется сценарий отправки сообщения указанному клиенту.
  Нужные данные для этого сценария:
  * `Sender` - Логин отправителя.
  * `Recepient` - Логин получателя.
  * `DateTime` - Время отправки сообщения.
  * `TextMessage` - Текст сообщения.
* `FileMessage` - Если сервер получил данное значение, то выполняется сценарий отправки файла указанному клиенту.
  Нужные данные для этого сценария:
  * `Sender` - Логин отправителя.
  * `Recepient` - Логин получателя.
  * `DateTime` - Время отправки сообщения.
  * `FileName` - Ссылка на файл.
* `GetMessages` - Если сервер получил данное значение, то выполняется сценарий отправки истории сообщений указанному клиенту.
  После выполнения сценария, клиенту должно быть отправлено `AmountMessages` экземпляров данного класа, в каждом из которых будет
  указан `TextMessage` - сообщение и `DateTime` - дата сохранения этого сообщения, но каждый раз это будет другое сообщение и время из истории.
  Нужные данные для этого сценария:
  * `Sender` - Логин отправителя.
  * `Recepient` - Логин получателя.
  * `DateTime` - Время отправки сообщения .
  * `AmountMessages` - Количество запрашиваемых сообщений из истории.
  
```C#
public string Sender { get; set; }
```
Логин отправителя.

```C#
public string Recepient { get; set; }
```
Логин получателя.

```C#
public DateTime DateTime { get; set; }
```
Дата отправки сообщения.

```C#
public string TextMessage { get; set; }
```
Текст сообщения.

```C#
public string FileName { get; set; }
```
Ссылка на файл.

```C#
public int AmountMessages { get; set; }
```
Количество файлов, которые хочет получить клиент из истории с каким-либо пользователем.

### Методы

### 1. Возможность десериализовать JSON в экземпляр класса `Message`
```C#
public static bool CanDeserialize(string json)
```
Если был передан корректный JSON, который можно десериализовать в экземпляр данного класа,
то возвращается `true`, иначе `false`.

### 2. Десериализация JSON'a в экземпляр данного класса
```C#
public static Message Deserialize(string json)
```
Возвращается экземпляр данного класса, либо `null`.

# Клиент

## Интерфейс `ISerializable`

### 1. Сериализация
```C#
public string Serialize();
```
Метод используется для того, чтобы сериализовать экземпляр класса. Возвращает JSON

### 2. Выполнение сценария после того, как клиент получил данный объект класса
```C#
public void Execute();
```
Метод вызывается сразу после успешной десериализации JSON'a. В зависимости от полученного типа команды, выполняется какой-то сценарий.
## Класс `AuthReg : ISerializable`
### Свойства
```C#
public AuthRegTypeOfCommand TypeOfCommand { get; set; }
```
Тип команды. Свойсвто отвечает за обработку этого JSON'a сервером/клиентом.
Возможны следующие значения данного свойства:
* `Registration` - Если клиент получил данное значение, то выполняется сценарий по обработке регистрации.
  Нужные данные для этого сценария:
  * `Success` - Если `true`, то регистрация прошла успешно, нужно перейти в сам мессенджер
    , если `false`, то авторизация не прошла, в `Message` будет указана ошибка
  * `Message` - Сообщение от сервера.
* `Authorization` - Если клиент получил данное значение, то выполняется сценарий авторизации.
  Нужные данные для этого сценария:
  * `Success` - Если `true`, то авторизация прошла успешно, нужно перейти в сам мессенджер
    , если `false`, то авторизация не прошла, в `Message` будет указана ошибка
  * `Message` - Сообщение от сервера.

```C#
public string Login { get; set; }
```
Логин пользователя

```C#
public string Password { get; set; }
```
Пароль пользователя

```C#
public bool Success { get; set; }
```
Является флагом успешной регистрации/авторизации для клиента.

```C#
public string Message { get; set; }
```
Сообщение, которое получит клиент после выполнения сценария.

```C#
public List<string> UserList { get; set; }
```
Список пользователей, которые есть в контактах у данного пользователя с логином `Login`. Инициализируется на сервере.

### Методы

### 1. Возможность десериализовать JSON в экземпляр класса `AuthReg`
```C#
public static bool CanDeserialize(string json)
```
Если был передан корректный JSON, который можно десериализовать в экземпляр данного класа,
то возвращается `true`, иначе `false`.

### 2. Десериализация JSON'a в экземпляр данного класса
```C#
public static AuthReg Deserialize(string json)
```
Возвращается экземпляр данного класса, либо `null`.

## Класс `Message : ISerializable`

### Свойства
```C#
public MessageTypeofCommand TypeOfCommand { get; set; }
```
Тип команды. Свойсвто отвечает за обработку этого JSON'a сервером/клиентом.
Возможны следующие значения данного свойства:
* `TextMessage` - Если клиент получил данное значение, то выполняется сценарий по получению сообщения от отправителя.
  Нужные данные для этого сценария:
  * `Sender` - Логин отправителя.
  * `DateTime` - Время отправки сообщения.
  * `TextMessage` - Текст сообщения.
* `FileMessage` - Если клиент получил данное значение, то выполняется сценарий по получению файла от отправителя.
  Нужные данные для этого сценария:
  * `Sender` - Логин отправителя.
  * `DateTime` - Время отправки сообщения.
  * `FileName` - Ссылка на файл.
* `GetMessages` - Если клиент получил данное значение, то выполняется сценарий по получению истории сообщений от `Recepient`.
  Будет сравниваться дата отправки сообщения, и в зависимости от нее будет определяться, в каком именно месте
  будет отображаться сообщение.
  Нужные данные для этого сценария:
  * `Recepient` - Логин пользователя от которого берется история сообщений.
  * `DateTime` - Время отправки сообщения.
  * `TextMessage` - Текст сообщения.
  
```C#
public string Sender { get; set; }
```
Логин отправителя.

```C#
public string Recepient { get; set; }
```
Логин получателя.

```C#
public DateTime DateTime { get; set; }
```
Дата отправки сообщения.

```C#
public string TextMessage { get; set; }
```
Текст сообщения.

```C#
public string FileName { get; set; }
```
Ссылка на файл.

```C#
public int AmountMessages { get; set; }
```
Количество файлов, которые хочет получить клиент из истории с каким-либо пользователем.

### Методы

### 1. Возможность десериализовать JSON в экземпляр класса `Message`
```C#
public static bool CanDeserialize(string json)
```
Если был передан корректный JSON, который можно десериализовать в экземпляр данного класа,
то возвращается `true`, иначе `false`.

### 2. Десериализация JSON'a в экземпляр данного класса
```C#
public static Message Deserialize(string json)
```
Возвращается экземпляр данного класса, либо `null`.